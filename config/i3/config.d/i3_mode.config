# ~/.config/i3/config.d/i3_mode.config
# vim: syntax=i3
# ======================================================================================
# All About Modes
# ======================================================================================
# This is to save all bindkeys of modes

# Insert mode
# Disable i3 configured keybindings. Inspired by vimium insert mode
set $mode_insert Insert: I3 bindkeys are disabled. Press Ctrl+left_bracket ([) to exit insert mode and get I3 bindkeys back
bindsym Ctrl+Mod1+i mode "$mode_insert"
mode "$mode_insert" {
    bindsym Ctrl+bracketleft mode "default"
}

# Vim keybinding mode
set $mode_vim_keybinding Vim keybindings: [(NONE/Alt/(Ctrl+Alt))+h/j/k/l]:Left/Down/Up/Right (repeat 1/4/8 times) [g/G]:Home/End [Ctrl+d/u]:PageDown/PageUp [d/i]:Delete/Insert [Ctrl+[]:Escape binding mode
bindsym Mod4+Ctrl+bracketleft mode "$mode_vim_keybinding"
mode "$mode_vim_keybinding" {
    # Navigation keys
    bindsym --release h exec xdotool key --clearmodifiers Left
    bindsym --release j exec xdotool key --clearmodifiers Down
    bindsym --release k exec xdotool key --clearmodifiers Up
    bindsym --release l exec xdotool key --clearmodifiers Right
    # Repeat navigation keys (4 times), short delay time is set to avoid key confrontation
    bindsym --release Mod1+h exec xdotool key --clearmodifiers --delay 0.01 Left Left Left Left
    bindsym --release Mod1+j exec xdotool key --clearmodifiers --delay 0.01 Down Down Down Down
    bindsym --release Mod1+k exec xdotool key --clearmodifiers --delay 0.01 Up Up Up Up Up
    bindsym --release Mod1+l exec xdotool key --clearmodifiers --delay 0.01 Right Right Right Right
    # Repeat navigation keys (8 times), short delay time is set to avoid key confrontation
    bindsym --release Ctrl+Mod1+h exec xdotool key --clearmodifiers --delay 0.005 Left Left Left Left Left Left Left Left
    bindsym --release Ctrl+Mod1+j exec xdotool key --clearmodifiers --delay 0.005 Down Down Down Down Down Down Down Down
    bindsym --release Ctrl+Mod1+k exec xdotool key --clearmodifiers --delay 0.005 Up Up Up Up Up Up Up Up Up Up
    bindsym --release Ctrl+Mod1+l exec xdotool key --clearmodifiers --delay 0.005 Right Right Right Right Right Right Right Right
    # Special keys
    bindsym --release g       exec xdotool key --clearmodifiers Home
    bindsym --release Shift+g exec xdotool key --clearmodifiers End
    bindsym --release d       exec xdotool key --clearmodifiers Delete
    bindsym --release i       exec xdotool key --clearmodifiers Insert
    bindsym --release Ctrl+d  exec xdotool key --clearmodifiers Next
    bindsym --release Ctrl+u  exec xdotool key --clearmodifiers Prior
    # i3 keybindings compatibility: move focus between output monitors ([/,/./])
    bindsym Mod4+bracketleft  focus output up
    bindsym Mod4+bracketright focus output down
    bindsym Mod4+period       focus output right
    bindsym Mod4+comma        focus output left
    # i3 keybindings compatibility: change focus
    bindsym Mod4+h focus left
    bindsym Mod4+j focus down
    bindsym Mod4+k focus up
    bindsym Mod4+l focus right
    # i3 keybindings compatibility: change focus between tiling/floating windows
    bindsym Mod4+space focus mode_toggle
    # i3 keybindings compatibility: toggle tiling/floating modes
    bindsym Mod4+Shift+space floating toggle
    # i3 keybindings compatibility: move focus window
    bindsym Mod4+Shift+h move left 50px
    bindsym Mod4+Shift+j move down 50px
    bindsym Mod4+Shift+k move up 50px
    bindsym Mod4+Shift+l move right 50px
    # i3 keybindings compatibility: kill focus window
    bindsym Mod4+Shift+q kill
    # Exit mode: "Ctrl"+"[" (vim-like Escape)
    bindsym Ctrl+bracketleft mode "default"
}

# Window layout mode
# Autotiling [https://github.com/nwg-piotr/autotiling]
# -- Installation: pip install autotiling
set $mode_window_layout Window layout: [h]split [v]split [t]abbed [s]tacking [(Shift)+f]:fullcreen (global) [e/d]:enable/disable auto_dwindling
bindsym Mod4+Shift+w mode "$mode_window_layout"
mode "$mode_window_layout" {
    # Tiling/Tabbed/Stacking
    bindsym h layout splith
    bindsym v layout splitv
    bindsym t layout tabbed
    bindsym s layout stacking
    # Fullscreen
    bindsym f       fullscreen toggle
    bindsym Shift+f fullscreen toggle global
    # Autotiling - Dwindling
    bindsym e exec $I3_SCRIPT/i3_autotiling_operator.sh enable_dwindling; mode "default"
    bindsym d exec $I3_SCRIPT/i3_autotiling_operator.sh disable_dwindling; mode "default"
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Titlebar mode
set $mode_titlebar Titlebar: [n]ew_name [r]estore_default_title [s]how_all_titles [h]ide_all_titles [t]oggle_all_titles [f]ontsize [T]itlebar_style
bindsym Mod4+Shift+t mode "$mode_titlebar"
mode "$mode_titlebar" {
    bindsym n       exec i3-msg title_format $(rofi -dmenu -lines 0 -p "New title name")
    bindsym r       title_format "%title"; exec notify-send -u low "i3 titlebar" "Restore Default Title Name"
    bindsym s       [all] border normal $default_border_width; exec notify-send -u low "i3 titlebar" "Show All Titlebars"
    bindsym h       [all] border pixel $default_border_width; exec notify-send -u low "i3 titlebar" "Hide All Titlebars"
    bindsym t       [all] border toggle $default_border_width; exec notify-send -u low "i3 titlebar" "Toggle All Titlebars"
    bindsym f       mode "$mode_titlebar_fontsize"
    bindsym Shift+t mode "$mode_titlebar_style"
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Titlebar fontsize mode (within titlebar mode)
set $mode_titlebar_fontsize Titlebar fontsize: [1]:8pix [2]:9pix [3]:10pix [4]:11pix [5]:12pix [6]:13pix [7]:14pix [8]:15pix [9]:16pix [0]:0pix
mode "$mode_titlebar_fontsize" {
    bindsym 1 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 8; mode "default"
    bindsym 2 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 9; mode "default"
    bindsym 3 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 10; mode "default"
    bindsym 4 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 11; mode "default"
    bindsym 5 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 12; mode "default"
    bindsym 6 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 13; mode "default"
    bindsym 7 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 14; mode "default"
    bindsym 8 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 15; mode "default"
    bindsym 9 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 16; mode "default"
    bindsym 0 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_fontsize 0; mode "default"
    # Back to titlebar mode: "Enter"
    bindsym Return mode "$mode_titlebar"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Titlebar style mode (within titlebar mode)
set $mode_titlebar_style Titlebar style: [1/2]:tiling_window normal/pixel (enable/disable titlebar) [3/4]:floating_window normal/pixel (enable/disable titlebar)
mode "$mode_titlebar_style" {
    bindsym 1 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_style normal; mode "default"
    bindsym 2 exec $I3_SCRIPT/i3_default_valuechanger.sh titlebar_style pixel; mode "default"
    bindsym 3 exec $I3_SCRIPT/i3_default_valuechanger.sh floating_titlebar_style normal; mode "default"
    bindsym 4 exec $I3_SCRIPT/i3_default_valuechanger.sh floating_titlebar_style pixel; mode "default"
    # Back to titlebar mode: "Enter"
    bindsym Return mode "$mode_titlebar"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Mark mode [use rofi as input]
# Automark windows [https://github.com/lincheney/i3-automark] is required
set $mode_mark Mark: [a]utomark [m]ark [u]nmark [(Shift)+single-quote/semicolumn]:(do not show titlebar but) go_to/swap_with marked window
bindsym Mod4+Shift+m mode "$mode_mark"
mode "$mode_mark" {
    # Automark mode
    bindsym a mode "$mode_automark"
    # Mark operation
    bindsym m                exec $I3_SCRIPT/i3_mark_operator.sh mark rofi none title_on; mode "default"
    bindsym u                exec $I3_SCRIPT/i3_mark_operator.sh unmark rofi none title_on; mode "default"
    bindsym apostrophe       exec $I3_SCRIPT/i3_mark_operator.sh show_then_goto rofi none title_on; mode "default"
    bindsym Shift+apostrophe exec $I3_SCRIPT/i3_mark_operator.sh show_then_goto rofi none title_off; mode "default"
    bindsym semicolon        exec $I3_SCRIPT/i3_mark_operator.sh show_then_swap rofi none title_on; mode "default"
    bindsym Shift+semicolon  exec $I3_SCRIPT/i3_mark_operator.sh show_then_swap rofi none title_off; mode "default"
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Automark mode
set $mode_automark Automark: [e]nable_automark_daemon [d]isable_automark_daemon [(Shift)+u]:unmark_all_automark (and remark)
mode "$mode_automark" {
    # Automark daemon
    bindsym e exec $I3_SCRIPT/i3_automark_operator.sh enable; mode "default"
    bindsym d exec $I3_SCRIPT/i3_automark_operator.sh disable; mode "default"
    # Unmark automark
    bindsym u       exec $I3_SCRIPT/i3_mark_operator.sh unmark_all_automark
    bindsym Shift+u exec $I3_SCRIPT/i3_mark_operator.sh unmark_all_automark_and_remark
    # Back to mark mode: "Enter"
    bindsym Return mode "$mode_mark"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Workspace mode
set $mode_workspace Workspace: [s]ave [r]estore [n]ew_name [(Shift)+k]:kill [g/single-quote]:go_to [grave/double-quote]:move_window_to [Esc/semicolon]:swap_with [R]eload_name_for_rofi
bindsym Mod4+Shift+p mode $mode_workspace
mode "$mode_workspace" {
    # Save/Restore mode
    bindsym r mode $mode_restore_workspace
    bindsym s mode $mode_save_workspace
    # Current workspace operation
    bindsym n exec $I3_SCRIPT/i3_workspace_operator.sh rename_current; mode "default"
    bindsym k exec $I3_SCRIPT/i3_workspace_operator.sh kill_current; mode "default"
    # Selected workspace operation
    bindsym Shift+k          exec $I3_SCRIPT/i3_workspace_operator.sh kill; mode "default"
    bindsym g                exec $I3_SCRIPT/i3_workspace_operator.sh goto; mode "default"
    bindsym apostrophe       exec $I3_SCRIPT/i3_workspace_operator.sh goto; mode "default"
    bindsym grave            exec $I3_SCRIPT/i3_workspace_operator.sh move_container; mode "default"
    bindsym Shift+apostrophe exec $I3_SCRIPT/i3_workspace_operator.sh move_container; mode "default"
    bindsym Escape           exec $I3_SCRIPT/i3_workspace_operator.sh swap; mode "default"
    bindsym semicolon        exec $I3_SCRIPT/i3_workspace_operator.sh swap; mode "default"
    # Generate workspace name list for rofi selector
    bindsym Shift+r exec $I3_SCRIPT/i3_genereate_workspace_name_list.sh; reload
    # Exit mode: "Enter" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Swap workspace mode (integrated with workspace mode)
set $mode_swap_workspace Swap workspace: [i]nteractive [Win+1~0]:A1~A0 (0~9) [Win+F1~F10]:B1~B0 (10~19) [Ctrl+F1~F10]:C1~C0 (20~29) [Alt+F1~F10]:D1~D0 (30~39) [Enter]:workspace_mode
bindsym Mod4+p mode $mode_swap_workspace
mode "$mode_swap_workspace" {
    # Swap interactively
    bindsym i exec $I3_SCRIPT/i3_workspace_operator.sh swap; mode "default"
    # Swap first 40 workspaces with index
    bindsym Mod4+1   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 0; mode "default"
    bindsym Mod4+2   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 1; mode "default"
    bindsym Mod4+3   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 2; mode "default"
    bindsym Mod4+4   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 3; mode "default"
    bindsym Mod4+5   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 4; mode "default"
    bindsym Mod4+6   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 5; mode "default"
    bindsym Mod4+7   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 6; mode "default"
    bindsym Mod4+8   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 7; mode "default"
    bindsym Mod4+9   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 8; mode "default"
    bindsym Mod4+0   exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 9; mode "default"
    bindsym Mod4+F1  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 10; mode "default"
    bindsym Mod4+F2  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 11; mode "default"
    bindsym Mod4+F3  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 12; mode "default"
    bindsym Mod4+F4  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 13; mode "default"
    bindsym Mod4+F5  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 14; mode "default"
    bindsym Mod4+F6  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 15; mode "default"
    bindsym Mod4+F7  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 16; mode "default"
    bindsym Mod4+F8  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 17; mode "default"
    bindsym Mod4+F9  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 18; mode "default"
    bindsym Mod4+F10 exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 19; mode "default"
    bindsym Ctrl+F1  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 20; mode "default"
    bindsym Ctrl+F2  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 21; mode "default"
    bindsym Ctrl+F3  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 22; mode "default"
    bindsym Ctrl+F4  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 23; mode "default"
    bindsym Ctrl+F5  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 24; mode "default"
    bindsym Ctrl+F6  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 25; mode "default"
    bindsym Ctrl+F7  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 26; mode "default"
    bindsym Ctrl+F8  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 27; mode "default"
    bindsym Ctrl+F9  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 28; mode "default"
    bindsym Ctrl+F10 exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 29; mode "default"
    bindsym Mod1+F1  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 30; mode "default"
    bindsym Mod1+F2  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 31; mode "default"
    bindsym Mod1+F3  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 32; mode "default"
    bindsym Mod1+F4  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 33; mode "default"
    bindsym Mod1+F5  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 34; mode "default"
    bindsym Mod1+F6  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 35; mode "default"
    bindsym Mod1+F7  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 36; mode "default"
    bindsym Mod1+F8  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 37; mode "default"
    bindsym Mod1+F9  exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 38; mode "default"
    bindsym Mod1+F10 exec $I3_SCRIPT/i3_workspace_operator.sh swap_with_index 39; mode "default"
    # Back to workspace mode: "Enter"
    bindsym Return mode "$mode_workspace"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Save workspace mode (within workspace mode)
set $mode_save_workspace Save workspace: [i]nteractively_select_workspace [s]ave_current_workspace [S]ave_all_workspaces
mode "$mode_save_workspace" {
    # Save interactively
    bindsym i exec $I3_SCRIPT/i3_workspace_operator.sh save
    # Save current workspace
    bindsym s exec $I3_SCRIPT/i3_workspace_operator.sh save_current; mode "$mode_workspace"
    # Save all workspaces
    bindsym Shift+s exec $I3_SCRIPT/i3_workspace_operator.sh save_all; mode "$mode_workspace"
    # Back to workspace mode: "Enter"
    bindsym Return mode "$mode_workspace"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Restore workspace mode (within workspace mode)
set $mode_restore_workspace Restore workspace: [i]nteractively_select_workspace [r]estore_current_workspace [R]estore_all_workspaces
mode "$mode_restore_workspace" {
    # Restore interactively
    bindsym i exec $I3_SCRIPT/i3_workspace_operator.sh restore
    # Restore current workspace
    bindsym r exec $I3_SCRIPT/i3_workspace_operator.sh restore_current; mode "$mode_workspace"
    # Restore all workspaces
    bindsym Shift+r exec $I3_SCRIPT/i3_workspace_operator.sh restore_all; mode "$mode_workspace"
    # Back to workspace mode: "Enter"
    bindsym Return mode "$mode_workspace"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Resize window (you can also use the mouse for that)
set $mode_resize Resize: [Ctrl/NONE/Alt+(vim-key)]:S/M/L step (left/down/up/right) [Win+Shift+(vim-key)]:move (left/down/up/right)
bindsym Ctrl+Mod1+r mode "$mode_resize"
mode "$mode_resize" {
    # Resize in small step
    bindsym Ctrl+h resize shrink width 1 px or 1 ppt
    bindsym Ctrl+j resize grow height 1 px or 1 ppt
    bindsym Ctrl+k resize shrink height 1 px or 1 ppt
    bindsym Ctrl+l resize grow width 1 px or 1 ppt
    # Resize in intermediate step
    bindsym h resize shrink width 5 px or 5 ppt
    bindsym j resize grow height 5 px or 5 ppt
    bindsym k resize shrink height 5 px or 5 ppt
    bindsym l resize grow width 5 px or 5 ppt
    # Resize in large step
    bindsym Mod1+h resize shrink width 10 px or 10 ppt
    bindsym Mod1+j resize grow height 10 px or 10 ppt
    bindsym Mod1+k resize shrink height 10 px or 10 ppt
    bindsym Mod1+l resize grow width 10 px or 10 ppt
    # i3 keybindings compatibility: move focus window
    bindsym Mod4+Shift+h move left
    bindsym Mod4+Shift+j move down
    bindsym Mod4+Shift+k move up
    bindsym Mod4+Shift+l move right
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Redshift mode
# -- https://confluence.jaytaala.com/display/TKB/Redshift+on+i3wm
set $mode_redshift Redshift: [1]:2000K [2]:2500K [3]:3000K [4]:3500K [5]:4000K [6]:4500K [7]:5000K [8]:5500K [9]:6000K [0]:killall_reshift
bindsym Mod4+Shift+z mode "$mode_redshift"
mode "$mode_redshift" {
    bindsym 1 exec redshift -m randr -P -O 2000
    bindsym 2 exec redshift -m randr -P -O 2500
    bindsym 3 exec redshift -m randr -P -O 3000
    bindsym 4 exec redshift -m randr -P -O 3500
    bindsym 5 exec redshift -m randr -P -O 4000
    bindsym 6 exec redshift -m randr -P -O 4500
    bindsym 7 exec redshift -m randr -P -O 5000
    bindsym 8 exec redshift -m randr -P -O 5500
    bindsym 9 exec redshift -m randr -P -O 6000
    bindsym 0 exec redshift -m randr -P -x; mode "default"
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# System manager mode
set $mode_system System: [k]eyboard [l]ock [e]xit [s]uspend [h]ibernate [r]eboot [p]oweroff [(Shift)+c]:caffeine on/(off)
bindsym Mod4+Shift+Escape mode "$mode_system"
mode "$mode_system" {
    # Keyboard mode
    bindsym k mode "$mode_keyboard"
    # System
    bindsym l exec loginctl lock-session && sleep 1 && xset dpms force off; mode "default"
    bindsym r exec systemctl reboot; mode "default"
    bindsym p exec systemctl poweroff; mode "default"
    bindsym e exec i3-msg exit; mode "default"
    bindsym s exec i3-msg suspend; mode "default"
    bindsym h exec i3-msg hibernate; mode "default"
    # Enable/Disable X screen saver (caffeine-like function)
    bindsym c       exec xset s 0 0 dpms 0 0 0; exec notify-send -u low "System xset" "Caffeine On (Disable X Screensaver)"; mode "default"
    bindsym Shift+c exec xset s 600 600 dpms 600 600 600; exec notify-send -u low "System xset" "Caffeine Off (Enable X screenxsaver)"; mode "default"
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Keyboard mode
set $mode_keyboard Keyboard: [Ctrl+Alt+l]:Send CapsLock key [1/2]:Speed-up/Reset repeat key rate [3/4]:Map/Swap Capslock to Ctrl [5]:Reset Capslock
mode "$mode_keyboard" {
    # Send Capslock key
    bindsym Ctrl+Mod1+l exec xdotool key Caps_Lock
    # Repeat key
    bindsym 1 exec xset r rate 300 40 && notify-send -u low "Keyboard" "Speed up repeat key rate (300/40)"; mode "default"
    bindsym 2 exec xset r rate 660 25 && notify-send -u low "Keyboard" "Reset repeat key rate (600/25)"; mode "default"
    # Capslock key
    bindsym 3 exec setxkbmap -option "ctrl:nocaps" && notify-send -u low "Keyboard" "Map Caplock to Ctrl"; mode "default"
    bindsym 4 exec setxkbmap -option "ctrl:swapcaps" && notifyd-send -u low "Keyboard" "Swap Caplock with Ctrl"; mode "default"
    bindsym 5 exec setxkbmap -option "ctrl:aa_ctrl" && notify-send -u low "Keyboard" "Restore Caplock"; mode "default"
    # Back to system mode: "Enter"
    bindsym Return mode "$mode_system"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Dunst mode (notification daemon)
bindsym Mod4+Shift+v mode "$mode_dunst"
set $mode_dunst Dunst (notification daemon): [c]lose [o]pen_context [h]istory-pop [C]lose_all [p]ause_dunst [r]esume_dunst [R]eload_dunst
mode "$mode_dunst" {
    bindsym c       exec dunstctl close
    bindsym o       exec dunstctl context
    bindsym h       exec dunstctl history-pop
    bindsym Shift+c exec dunstctl close-all
    bindsym p       exec dunstctl set-paused true; mode "default"
    bindsym r       exec dunstctl set-paused false
    bindsym Shift+r exec $I3_SCRIPT/i3_dunst_walcolor.sh reload
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Player mode with youtube-like player control (j/k/l: previous/play-pause/next)
# Note: spotifyd, spt, vlc must be installed
bindsym Ctrl+Mod1+p mode "$mode_player"
set $mode_player Player: [v]olume [s]potifyd [P/p]laying [{Ctrl+Alt}/Ctrl/NONE/Alt+(Shift)+j/k/l]:{selector}/spotify/current/vlc (prev)/-10s/(stop)/play-pause/(next)/+10s [Ctrl+Alt+Shift+Space]:stop all
mode "$mode_player" {
    # Volume mode (with pulsemixer)
    bindsym v mode "$mode_volume"
    # Spotifyd mode
    bindsym s mode "$mode_spotifyd"
    # Show playing information
    bindsym p       exec $I3_SCRIPT/i3_MPRIS_notification.sh playing
    bindsym Shift+p exec $I3_SCRIPT/i3_MPRIS_notification.sh playing_all
    # Spt (spotify frontend) control for spotifyd (spotify daemon)
    bindsym Ctrl+j exec spt playback --device spotifyd --seek -10
    bindsym Ctrl+k exec spt playback --device spotifyd --toggle
    bindsym Ctrl+l exec spt playback --device spotifyd --seek +10
    # Media player control for spotifyd (spotify daemon)
    bindsym Ctrl+Shift+j exec playerctl -p spotifyd previous
    bindsym Ctrl+Shift+k exec playerctl -p spotifyd stop
    bindsym Ctrl+Shift+l exec playerctl -p spotifyd next
    # Media player control
    bindsym j       exec playerctl position 10-
    bindsym k       exec playerctl play-pause && $I3_SCRIPT/i3_MPRIS_notification.sh playing
    bindsym l       exec playerctl position 10+
    bindsym Shift+j exec playerctl previous && $I3_SCRIPT/i3_MPRIS_notification.sh playing
    bindsym Shift+k exec playerctl stop
    bindsym Shift+l exec playerctl next && $I3_SCRIPT/i3_MPRIS_notification.sh playing
    # Media player control for vlc (media player)
    bindsym Mod1+j       exec playerctl -p vlc position 10-
    bindsym Mod1+k       exec playerctl -p vlc play-pause
    bindsym Mod1+l       exec playerctl -p vlc position 10+
    bindsym Mod1+Shift+j exec playerctl -p vlc previous
    bindsym Mod1+Shift+k exec playerctl -p vlc stop
    bindsym Mod1+Shift+l exec playerctl -p vlc next
    # Interactive media player control
    bindsym Ctrl+Mod1+j       exec $I3_SCRIPT/i3_MPRIS_operator.sh rewind
    bindsym Ctrl+Mod1+k       exec $I3_SCRIPT/i3_MPRIS_operator.sh play-pause
    bindsym Ctrl+Mod1+l       exec $I3_SCRIPT/i3_MPRIS_operator.sh fast-forward
    bindsym Ctrl+Mod1+Shift+j exec $I3_SCRIPT/i3_MPRIS_operator.sh prev
    bindsym Ctrl+Mod1+Shift+k exec $I3_SCRIPT/i3_MPRIS_operator.sh stop
    bindsym Ctrl+Mod1+Shift+l exec $I3_SCRIPT/i3_MPRIS_operator.sh next
    # Stop all media players
    bindsym Ctrl+Mod1+Shift+space exec playerctl stop --all-players
    # Specital key compatibility: media player control
    bindsym XF86AudioPlay        exec playerctl play-pause && $I3_SCRIPT/i3_MPRIS_notification.sh
    bindsym XF86AudioPause       exec playerctl play-pause && $I3_SCRIPT/i3_MPRIS_notification.sh
    bindsym Shift+XF86AudioPause exec playerctl stop
    bindsym XF86AudioStop        exec playerctl stop
    bindsym XF86AudioNext        exec playerctl next && $I3_SCRIPT/i3_MPRIS_notification.sh
    bindsym XF86AudioPrev        exec playerctl previous && $I3_SCRIPT/i3_MPRIS_notification.sh
    # Specital key compatibility: media player control for spotifyd (spotify daemon)
    bindsym Ctrl+XF86AudioPlay  exec playerctl -p spotifyd play-pause
    bindsym Ctrl+XF86AudioPause exec playerctl -p spotifyd play-pause
    bindsym Ctrl+XF86AudioStop  exec playerctl -p spotifyd stop
    bindsym Ctrl+XF86AudioNext  exec playerctl -p spotifyd next
    bindsym Ctrl+XF86AudioPrev  exec playerctl -p spotifyd previous
    # Specital key compatibility: media player control for vlc
    bindsym Mod1+XF86AudioPlay  exec playerctl -p vlc play-pause
    bindsym Mod1+XF86AudioPause exec playerctl -p vlc play-pause
    bindsym Mod1+XF86AudioStop  exec playerctl -p vlc stop
    bindsym Mod1+XF86AudioNext  exec playerctl -p vlc next
    bindsym Mod1+XF86AudioPrev  exec playerctl -p vlc previous
    # Specital key compatibility: media player control for all players
    bindsym Ctrl+Mod1+XF86AudioPlay       exec playerctl -a play-pause
    bindsym Ctrl+Mod1+Shift+XF86AudioPlay exec playerctl -a stop
    bindsym Ctrl+Mod1+XF86AudioStop       exec playerctl -a stop
    # Dunst compatibility: notification actions
    bindsym Ctrl+space       exec dunstctl close
    bindsym Ctrl+Shift+space exec dunstctl history-pop
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Spotifyd mode
# Note: spotifyd must be installed
bindsym Ctrl+Mod1+s mode "$mode_spotifyd"
set $mode_spotifyd Spotifyd: [p]laying [s]tatus [e]nable_spotifyd [d]isable_spotifyd [a]ttach_spotifyd_to_spt [r]eload_spotifyd [R]eload_spotifyd_and_attach_it_to_spt [Enter]:player_mode
mode "$mode_spotifyd" {
    bindsym p       exec $I3_SCRIPT/i3_spotifyd_operator.sh playing
    bindsym s       exec $I3_SCRIPT/i3_spotifyd_operator.sh status
    bindsym e       exec $I3_SCRIPT/i3_spotifyd_operator.sh enable
    bindsym d       exec $I3_SCRIPT/i3_spotifyd_operator.sh disable
    bindsym a       exec $I3_SCRIPT/i3_spotifyd_operator.sh attach
    bindsym r       exec $I3_SCRIPT/i3_spotifyd_operator.sh reload
    bindsym Shift+r exec $I3_SCRIPT/i3_spotifyd_operator.sh reload_and_attach
    # Go to player mode: "Enter"
    bindsym Return mode "$mode_player"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Volume mode
# Note: pulsemixer, alsa-utils must be installed
bindsym Ctrl+Mod1+v mode "$mode_volume"
set $mode_volume Volume: [v]olume [p]ulsemixer [a]lsamixer [c]hannel_check [m]ute_toggle [Ctrl/NONE/Alt+-/+]:1%/5%/10% decrease/increase [Enter]:player_mode
mode "$mode_volume" {
    # Show volume
    bindsym v exec $I3_SCRIPT/i3_pulsemixer_notification.sh
    # Pulsemixer (CLI and curses mixer for PulseAudio)
    bindsym p exec --no-startup-id kitty --class floating_kitty -e pulsemixer; mode "default"
    # Alsamixer (soundcard mixer for ALSA soundcard driver)
    bindsym a exec --no-startup-id kitty --class floating_kitty -e alsamixer; mode "default"
    # Stereo channel check (default: 2 channels)
    bindsym c exec --no-startup-id kitty --class floating_kitty -e speaker-test -t wav -c 2
    # Toggle mute
    bindsym m exec pulsemixer --toggle-mute && $I3_SCRIPT/i3_pulsemixer_notification.sh
    # Volume (small/intermediate/large step)
    bindsym Ctrl+minus exec pulsemixer --change-volume -1 && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Ctrl+plus  exec pulsemixer --change-volume +1 && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym minus      exec pulsemixer --change-volume -5 && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym plus       exec pulsemixer --change-volume +5 && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Mod1+minus exec pulsemixer --change-volume -10 && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Mod1+plus  exec pulsemixer --change-volume +10 && $I3_SCRIPT/i3_pulsemixer_notification.sh
    # Special key compatibility: volume adjustment
    bindsym XF86AudioMicMute          exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
    bindsym XF86AudioMute             exec pactl set-sink-mute @DEFAULT_SINK@ toggle && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Ctrl+XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +1% && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Ctrl+XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -1% && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym XF86AudioRaiseVolume      exec pactl set-sink-volume @DEFAULT_SINK@ +5% && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym XF86AudioLowerVolume      exec pactl set-sink-volume @DEFAULT_SINK@ -5% && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Mod1+XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +10% && $I3_SCRIPT/i3_pulsemixer_notification.sh
    bindsym Mod1+XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -10% && $I3_SCRIPT/i3_pulsemixer_notification.sh
    # Dunst compatibility: notification actions
    bindsym Ctrl+space       exec dunstctl close
    bindsym Ctrl+Shift+space exec dunstctl history-pop
    # Go to player mode: "Enter"
    bindsym Return mode "$mode_player"
    # Exit mode: "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Mouse emulation by keyboard mapping
# -- https://www.reddit.com/r/i3wm/comments/ltjoaa/tip_mouse_emulation_using_hjkl/
# Note: xdotool must be installed
set $mode_mouse Mouse emulator: [Ctrl/NONE/Alt+(vim-key)]:S/M/L move [Ctrl/NONE/Alt+u/i/o]:L/M/R click-and-hold/click/release [Ctrl/NONE/Alt+,/.]:S/M/L scroll down/up [e/d]:enable/disable autohide
bindsym Ctrl+Mod1+m mode "$mode_mouse"
mode "$mode_mouse" {
    # left up down right --smaller steps
    bindsym Ctrl+h exec "xdotool mousemove_relative -- -5 0"
    bindsym Ctrl+j exec "xdotool mousemove_relative 0 5"
    bindsym Ctrl+k exec "xdotool mousemove_relative -- 0 -5"
    bindsym Ctrl+l exec "xdotool mousemove_relative 5 0"
    # left up down right
    bindsym h exec "xdotool mousemove_relative -- -50 0"
    bindsym j exec "xdotool mousemove_relative 0 50"
    bindsym k exec "xdotool mousemove_relative -- 0 -50"
    bindsym l exec "xdotool mousemove_relative 50 0"
    # left up down right -- larger steps
    bindsym Mod1+h exec "xdotool mousemove_relative -- -200 0"
    bindsym Mod1+j exec "xdotool mousemove_relative 0 200"
    bindsym Mod1+k exec "xdotool mousemove_relative -- 0 -200"
    bindsym Mod1+l exec "xdotool mousemove_relative 200 0"
    # click-and-hold: left mid right
    bindsym Ctrl+u exec "xdotool mousedown 1"
    bindsym Ctrl+i exec "xdotool mousedown 2"
    bindsym Ctrl+o exec "xdotool mousedown 3"
    # click: left mid right
    bindsym u exec "xdotool click 1"
    bindsym i exec "xdotool click 2"
    bindsym o exec "xdotool click 3"
    # release: left mid right
    bindsym Mod1+u exec "xdotool mouseup 1"
    bindsym Mod1+i exec "xdotool mouseup 2"
    bindsym Mod1+o exec "xdotool mouseup 3"
    # click: scroll wheel up/down
    bindsym Ctrl+period exec "xdotool click 4"
    bindsym Ctrl+comma  exec "xdotool click 5"
    # click: scroll wheel up/down -- repeat 2 times
    bindsym period exec "xdotool click --delay 0.01 --repeat 2 4"
    bindsym comma  exec "xdotool click --delay 0.01 --repeat 2 5"
    # click: scroll wheel up/down -- repeat 10 times
    bindsym Mod1+period exec "xdotool click --delay 0.005 --repeat 10 4"
    bindsym Mod1+comma  exec "xdotool click --delay 0.005 --repeat 10 5"
    # cursor autohide [unclutter-xfixes need to be installed]
    bindsym e exec "unclutter --timeout 3 --start-hidden"; mode "default"
    bindsym d exec "killall unclutter"; mode "default"
    # i3 keybindings compatibility: move focus between output monitors ([/,/./])
    bindsym Mod4+bracketleft  focus output up
    bindsym Mod4+bracketright focus output down
    bindsym Mod4+period       focus output right
    bindsym Mod4+comma        focus output left
    # i3 keybindings compatibility: change focus
    bindsym Mod4+h focus left
    bindsym Mod4+j focus down
    bindsym Mod4+k focus up
    bindsym Mod4+l focus right
    # i3 keybindings compatibility: change focus between tiling/floating windows
    bindsym Mod4+space focus mode_toggle
    # i3 keybindings compatibility: toggle tiling/floating modes
    bindsym Mod4+Shift+space floating toggle
    # i3 keybindings compatibility: move focus window
    bindsym Mod4+Shift+h move left 50px
    bindsym Mod4+Shift+j move down 50px
    bindsym Mod4+Shift+k move up 50px
    bindsym Mod4+Shift+l move right 50px
    # i3 keybindings compatibility: mouse button actions
    bindsym Mod4+i kill
    bindsym Mod4+o floating toggle
    # i3 keybindings compatibility: kill focus window
    bindsym Mod4+Shift+q kill
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Display mode (use xrandr)
# -- https://thevaluable.dev/i3-config-mouseless/
# For my monitor physical setup: laptop [eDP1 13'] + external {[HDMI1 27'], [HDMI1 24']}
set $mode_display Display: [a]utomatic [A]randr [1/2]:eDP1/HDMI1 Only [3/4]:eDP1+HDMI1 Joint/Mirror [H/h]:HDMI1 1920x1080/1920x1200 [E/e]:eDP1 1920x1080/1440x810 [P/p]:Primary HDMI1/eDP1
bindsym Mod4+Shift+x mode "$mode_display"
mode "$mode_display" {
    # Set automatically with preset scripts
    bindsym a exec $I3_SCRIPT/i3_display_monitor_adopter.sh auto $default_conky_startup; mode "default"
    # Arandr (xrandr GUI)
    bindsym Shift+a exec arandr; mode "default"
    # Preset display sets
    bindsym 1 exec $I3_SCRIPT/i3_display_monitor_adopter.sh option eDP1_only $default_conky_startup; mode "default"
    bindsym 2 exec $I3_SCRIPT/i3_display_monitor_adopter.sh option HDMI1_only $default_conky_startup; mode "default"
    bindsym 3 exec $I3_SCRIPT/i3_display_monitor_adopter.sh option eDP1_HDMI1_joint $default_conky_startup; mode "default"
    bindsym 4 exec $I3_SCRIPT/i3_display_monitor_adopter.sh option eDP1_HDMI1_mirror $default_conky_startup; mode "default"
    # Monitor resolution
    bindsym h       exec $I3_SCRIPT/i3_display_monitor_adopter.sh option HDMI1_extend $default_conky_startup; mode "default"
    bindsym Shift+h exec $I3_SCRIPT/i3_display_monitor_adopter.sh option HDMI1_default $default_conky_startup; mode "default"
    bindsym e       exec $I3_SCRIPT/i3_display_monitor_adopter.sh option eDP1_shrink $default_conky_startup; mode "default"
    bindsym Shift+e exec $I3_SCRIPT/i3_display_monitor_adopter.sh option eDP1_default $default_conky_startup; mode "default"
    # Primary Monitor
    bindsym p       exec $I3_SCRIPT/i3_display_monitor_adopter.sh option eDP1_primary disable; mode "default"
    bindsym Shift+p exec $I3_SCRIPT/i3_display_monitor_adopter.sh option HDMI1_primary disable; mode "default"
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}

# Backlight mode
# Note: xbacklight must be installed
set $mode_backlight Backlight: [x]backlight [Ctrl/NONE/Alt+-/+]:1%/5%/10% decrease/increase [Ctrl/(Ctrl+Alt)/Alt+Shift+0]:set to 0.1%/50%/100%
bindsym Ctrl+Mod1+x mode "$mode_backlight"
mode "$mode_backlight" {
    # Show backlight
    bindsym x exec $I3_SCRIPT/i3_xbacklight_notification.sh
    # Backlight (small/intermediate/large step)
    bindsym Ctrl+minus exec xbacklight -dec 1 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Ctrl+plus  exec xbacklight -inc 1 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym minus      exec xbacklight -dec 5 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym plus       exec xbacklight -inc 5 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Mod1+minus exec xbacklight -dec 10 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Mod1+plus  exec xbacklight -inc 10 && $I3_SCRIPT/i3_xbacklight_notification.sh
    # Backlight (Min/Intermediate/Max)
    bindsym Ctrl+Shift+0      exec xbacklight -set 0.1 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Ctrl+Mod1+Shift+0 exec xbacklight -set 50.1 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Mod1+Shift+0      exec xbacklight -set 100.0 && $I3_SCRIPT/i3_xbacklight_notification.sh
    # Special key compatibility: backlight control
    bindsym Ctrl+XF86MonBrightnessDown exec xbacklight -dec 1 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Ctrl+XF86MonBrightnessUp   exec xbacklight -inc 1 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym XF86MonBrightnessDown      exec xbacklight -dec 5 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym XF86MonBrightnessUp        exec xbacklight -inc 5 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Mod1+XF86MonBrightnessDown exec xbacklight -dec 10 && $I3_SCRIPT/i3_xbacklight_notification.sh
    bindsym Mod1+XF86MonBrightnessUp   exec xbacklight -inc 10 && $I3_SCRIPT/i3_xbacklight_notification.sh
    # Dunst compatibility: notification actions
    bindsym Ctrl+space       exec dunstctl close
    bindsym Ctrl+Shift+space exec dunstctl history-pop
    # Exit mode: "Enter", "Escape" or "Ctrl"+"[" (vim-like Escape)
    bindsym Return           mode "default"
    bindsym Escape           mode "default"
    bindsym Ctrl+bracketleft mode "default"
}
